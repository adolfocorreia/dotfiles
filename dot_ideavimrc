""" Leader mappings

let mapleader = " "

" List available actions with :actionlist
" Enable action tracking with :set trackactionids
" List current maps with :map


""" Handlers

" Use IdeaVim for Ctrl bindings
sethandler <C-6> a:vim
sethandler <C-A> a:vim
sethandler <C-B> a:vim
sethandler <C-C> a:vim
sethandler <C-D> a:vim
sethandler <C-E> a:vim
sethandler <C-F> a:vim
sethandler <C-G> a:vim
sethandler <C-H> a:vim
sethandler <C-I> a:vim
sethandler <C-J> a:vim
sethandler <C-K> a:vim
sethandler <C-L> a:vim
sethandler <C-M> a:vim
sethandler <C-N> a:vim
sethandler <C-O> a:vim
sethandler <C-P> a:vim
sethandler <C-Q> a:vim
sethandler <C-R> a:vim
sethandler <C-S> a:ide " Save using Idea
sethandler <C-T> a:vim
sethandler <C-U> a:vim
sethandler <C-V> a:vim
sethandler <C-W> a:vim
sethandler <C-X> a:vim
sethandler <C-Y> a:vim
sethandler <C-Z> a:ide " Used to toggle IdeaVim on/off
sethandler <C-[> a:vim
sethandler <C-]> a:vim
sethandler <M-b> a:vim
sethandler <M-f> a:vim


""" Options
" Reference: https://github.com/JetBrains/ideavim/blob/master/doc/set-commands.md

set clipboard=ideaput,unnamed,unnamedplus

set hlsearch
set incsearch
set ignorecase
set smartcase

set number
set relativenumber

set scrolloff=2
set sidescrolloff=5

set splitbelow
set splitright


""" IdeaVim options

" Use Idea to join lines smartly
set ideajoin

" Use gray icon on status bar
set ideastatusicon=gray


""" Plugins
" Reference: https://github.com/JetBrains/ideavim/blob/master/doc/IdeaVim%20Plugins.md

" Install via marketplace:
" - IdeaVim
" - Tokyo Night Theme
" - AceJump:             https://github.com/acejump/AceJump
" - IdeaVimMulticursor:  https://github.com/dankinsoid/IdeaVimMulticursor
" - IdeaVim-Quickscope:  https://github.com/joshestein/ideavim-quickscope
" - IdeaVim-Sneak:       https://github.com/Mishkun/ideavim-sneak
" - Which-Key:           https://github.com/TheBlob42/idea-which-key

set surround
set commentary
set matchit
set exchange

set highlightedyank

set sneak
set quickscope

set multicursor

" NERDTree bindings: https://github.com/JetBrains/ideavim/wiki/NERDTree-support
set NERDTree

set which-key
set notimeout
let g:WhichKey_ShowVimActions = "true"

set argtextobj
let g:argtextobj_pairs="(:),{:},<:>,[:]"

set textobj-entire
set textobj-indent


""" Mappings
" Default mappings: https://github.com/JetBrains/ideavim/blob/master/src/main/java/com/maddyhome/idea/vim/package-info.java

nnoremap Y y$

nnoremap n nzzzv
nnoremap N Nzzzv

vnoremap < <gv
vnoremap > >gv

map g, <Action>(JumpToNextChange)
map g; <Action>(JumpToLastChange)


" Unimpaired-like bindings
nnoremap [<Space> O<Esc>j
nnoremap ]<Space> o<Esc>k

map [e <Action>(MoveLineUp)
map ]e <Action>(MoveLineDown)

nnoremap [p O<Esc>p
nnoremap ]p o<Esc>p

map [b <Action>(NextTab)
map ]b <Action>(PreviousTab)

map [[ <Action>(MethodUp)
map ]] <Action>(MethodDown)

map [d <Action>(GotoPreviousError)
map ]d <Action>(GotoNextError)

map [h <Action>(VcsShowPrevChangeMarker)
map ]h <Action>(VcsShowNextChangeMarker)


" RSI-like bindings
inoremap <C-b> <Left>
inoremap <C-f> <Right>
inoremap <M-b> <C-Left>
inoremap <M-f> <C-Right>
inoremap <C-a> <Home>
inoremap <C-e> <End>
inoremap <C-d> <Del>


" Plugin bindings
map gss <Action>(AceAction)


" Leader mappings
" Reference: https://github.com/MarcoIeni/intellimacs

" Leader
map <Leader><Leader> <Action>(GotoAction)

" Buffers
map <Leader>bb <Action>(RecentFiles)
map <Leader>bd <Action>(CloseContent)
map <Leader>bn <Action>(NextTab)
map <Leader>bp <Action>(PreviousTab)
map <Leader>bs <Action>(NewScratchBuffer)
map <Leader>bu <Action>(ReopenClosedTab)
map <Leader>bx <Action>(CloseAllEditors)

" Code
map <Leader>ca <Action>(ShowIntentionActions)
map <Leader>cc <Action>(ShowIntentionActions)
map <Leader>cf <Action>(ReformatCode)
map <Leader>ch <Action>(HighlightUsagesInFile)
map <Leader>ci <Action>(OptimizeImports)
map <Leader>cr <Action>(RenameElement)

" Files
map <Leader>ff <Action>(GotoFile)
map <Leader>fR <Action>(RenameFile)
map <Leader>fr <Action>(RecentFiles)
map <Leader>fS <Action>(SaveAll)
map <Leader>fs <Action>(SaveDocument)

" Git
map <leader>gg <Action>(Vcs.Show.Local.Changes)
map <leader>gl <Action>(Vcs.Show.Log)

" IdeaVim
map <Leader>ii :edit ~/.ideavimrc<CR>
map <Leader>ir <Action>(IdeaVim.ReloadVimRc.reload)

" Quit
map <Leader>qq <Action>(Exit)
map <Leader>qp <Action>(CloseProject)
map <Leader>qr <Action>(RestartIde)

" Search
map <Leader>se <Action>(SearchEverywhere)
map <Leader>su <Action>(ShowUsages)
map <Leader>sU <Action>(FindUsages)
map <Leader>sp <Action>(FindInPath)
map <Leader>sP <Action>(ReplaceInPath)
map <Leader>sa <Action>(GotoAction)
map <Leader>sc <Action>(GotoClass)
map <Leader>sf <Action>(GotoFile)
map <Leader>ss <Action>(GotoSymbol)
map <Leader>sn :nohlsearch<CR>

" Toggle
map <Leader>tt :NERDTreeToggle<CR>
map <Leader>tT <Action>(Terminal.OpenInTerminal)
